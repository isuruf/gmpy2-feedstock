diff --git a/src/gmpy2_mpz_misc.c b/src/gmpy2_mpz_misc.c
index 3fd0485..b02d8f2 100644
--- a/src/gmpy2_mpz_misc.c
+++ b/src/gmpy2_mpz_misc.c
@@ -1655,13 +1655,17 @@ GMPy_MPZ_Method_SubScript(MPZ_Object *self, PyObject *item)
 
 #if PY_VERSION_HEX > 0x030200A4
         if (PySlice_GetIndicesEx(item,
+                        mpz_sizeinbase(self->z, 2),
+                        &start, &stop, &step, &slicelength) < 0) {
+            return NULL;
+        }
 #else
         if (PySlice_GetIndicesEx((PySliceObject*)item,
-#endif
                         mpz_sizeinbase(self->z, 2),
                         &start, &stop, &step, &slicelength) < 0) {
             return NULL;
         }
+#endif
 
         if ((step < 0 && start < stop) || (step > 0 && start > stop)) {
             stop = start;

diff --git a/src/gmpy2_xmpz_misc.c b/src/gmpy2_xmpz_misc.c
index 4c5b6c5..526f7e3 100644
--- a/src/gmpy2_xmpz_misc.c
+++ b/src/gmpy2_xmpz_misc.c
@@ -191,13 +191,17 @@ GMPy_XMPZ_Method_SubScript(XMPZ_Object* self, PyObject* item)
 
 #if PY_VERSION_HEX > 0x030200A4
         if (PySlice_GetIndicesEx(item,
+                         mpz_sizeinbase(self->z, 2),
+                         &start, &stop, &step, &slicelength) < 0) {
+            return NULL;
+        }
 #else
         if (PySlice_GetIndicesEx((PySliceObject*)item,
-#endif
                          mpz_sizeinbase(self->z, 2),
                          &start, &stop, &step, &slicelength) < 0) {
             return NULL;
         }
+#endif
 
         if ((step < 0 && start < stop) || (step > 0 && start > stop)) {
             stop = start;
@@ -280,13 +284,17 @@ GMPy_XMPZ_Method_AssignSubScript(XMPZ_Object* self, PyObject* item, PyObject* va
 
 #if PY_VERSION_HEX > 0x030200A4
         if (PySlice_GetIndicesEx(item,
+                        seq_len,
+                        &start, &stop, &step, &slicelength) < 0) {
+            return -1;
+        }
 #else
         if (PySlice_GetIndicesEx((PySliceObject*)item,
-#endif
                         seq_len,
                         &start, &stop, &step, &slicelength) < 0) {
             return -1;
         }
+#endif
 
         if ((step < 0 && start < stop) || (step > 0 && start > stop)) {
             stop = start;
